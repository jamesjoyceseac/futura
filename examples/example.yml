{% set base_project = "Prospective_LCA_1" %}
{% set base_database = "ecoinvent" %}
{% set output_database = "ecoinvent_plus_CCS" %}

metadata:
    base_project: {{base_project}}
    base_database: {{base_database}}
    output_database: {{output_database}}
    description: >
        This Futura recipe loads the ecoinvent 3.3 database, adds Carma CCS projects,
        then alters the British and German high voltage electricity markets to shift
        50% of coal and lignite produced electricity to CCS respectively
load:
    - extract_bw2_database:
        project_name: {{base_project}}
        database_names:
            - {{base_database}}
    #- extract_excel_data:
    #    excelfilepath: lci-Carma-CCS.xlsx
            
technology:
    #- add_default_CCS_processes:
    #    default: True
    - add_technology_to_database:
        technology_file: __ASSET_PATH__/lci-Carma-CCS-base-GLO2.xlsx
        funcs:
            - fix_ch_only_processes
            - add_hard_coal_ccs
            - add_lignite_ccs
            #- add_natural_gas_ccs
            #- add_wood_ccs

markets:
    - alter_market:
        market_filter: [{'filter': 'equals', 'args': ['unit', 'kilowatt hour']},
                        {'filter': 'startswith', 'args': ['name', 'market']},
                        {'filter': 'contains', 'args': ['name', 'high']},
                        {'filter': 'equals', 'args': ['location', 'GB']}]
        tasks:
            - function: add_alternative_exchanges
              args: []
            - function: transfer_pv
              args:
                  - electricity production, hard coal
                  - Electricity, at power plant/hard coal, post, pipeline 200km, storage 1000m/2025
              kwargs:
                  factor: 0.5
            - function: relink
              args: []

    - alter_market:
          market_filter: [{'filter': 'equals', 'args': ['unit', 'kilowatt hour']},
                          {'filter': 'startswith', 'args': ['name', 'market']},
                          {'filter': 'contains', 'args': ['name', 'high']},
                          {'filter': 'equals', 'args': ['location', 'DE']}]
          tasks:
              - function: add_alternative_exchanges
                args: []
              - function: transfer_pv
                args:
                    - electricity production, lignite
                    - Electricity, at power plant/lignite, post, pipeline 200km, storage 1000m/2025
                kwargs:
                    factor: 0.5
              - function: relink
                args: []
